.CODE16

.GLOBL NL
.GLOBL HEX
.GLOBL PRINT
.GLOBL PRINT_HEX

PRINT_HEX:
	PUSH %BX
	PUSH %SI
	PUSH %AX
	XOR %AH, %AH
	SHR $4, %AL
	AND $0x0F, %AL
	ADD $HEX, %AX
	MOV %AX, %SI
	LODSB
	XORB %BH, %BH
	MOVB $0x0F, %BL
	MOVB $0x0E, %AH
	INT $0x10
	POP %AX
	PUSH %AX
	AND $0x0F, %AL
	ADD $HEX, %AX
	MOV %AX, %SI
	LODSB
	XORB %BH, %BH
	MOVB $0x0F, %BL
	MOVB $0x0E, %AH
	INT $0x10

	POP %AX
	POP %SI
	POP %BX
	RET

PRINT:
	PUSHA
PRINTSTART:
	XORB %BH, %BH
	MOVB $0x0F, %BL
	MOVB $0x0E, %AH
	LODSB
	OR %AL, %AL
	JZ PRINTDONE
	INT $0x10
	JMP PRINTSTART
PRINTDONE:
	POPA
	RET

.SECTION .rodata

NL: .ASCIZ "\r\n"
HEX: .ASCII "0123456789ABCDEF"